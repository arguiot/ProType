"use strict";var _createClass=function(){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}();function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var ProType=function(){function e(){_classCallCheck(this,e),this.version="v0.0.12",this.views=[],this.viewsName=[],this.controllers=[],this.currentView="",this.workspace={}}return _createClass(e,[{key:"Router",value:function(h){document.addEventListener("DOMContentLoaded",function(e){var t={},i=window.location.href;t.url=i;var n=window.location.origin;t.origin=n;var s=window.location.pathname;t.path=s;var r=window.location.hash;t.hash=r;for(var o=window.location.search.substring(1).split("&"),a={},l=0;l<o.length;l++){var u=o[l].split("=");a[decodeURIComponent(u[0])]=decodeURIComponent(u[1])}t.search=a,t.pathValue=s.split("/"),h(t)})}},{key:"autoMount",value:function(){var e,t=[].concat(Array.prototype.slice.call(arguments)),i=document.querySelectorAll("[protype]");if((e=this.views).push.apply(e,_toConsumableArray(i)),i.length!=t.length)throw"Controllers and Elements don't match";for(var n=0;n<i.length;n++)this.viewsName.push(i[n].getAttribute("protype"));for(var s=0;s<t.length;s++)this.controllers.push(new t[s](i[s],this.viewsName,this.views))}},{key:"Component",get:function(){return function(){function t(e){_classCallCheck(this,t),this.component=e,this.state={},this.render()}return _createClass(t,[{key:"render",value:function(){this.component.innerHTML=""}}]),t}()}},{key:"Group",get:function(){return function(){function n(e,t,i){_classCallCheck(this,n),this.group=e,this.groupName=t,this.viewName=i,this.state={},this.init()}return _createClass(n,[{key:"changeHandler",value:function(e){}}]),_createClass(n,[{key:"init",value:function(){}},{key:"mountComponent",value:function(e,t){return new t(e)}},{key:"setState",value:function(e){JSON.stringify(e)!=JSON.stringify(this.state)&&(this.state=e,this.changeHandler(this.state))}}]),n}()}},{key:"ViewController",get:function(){return function(){function s(e,t,i){_classCallCheck(this,s),this.view=e,this.views=i,this.viewsName=t;var n=this.views.indexOf(this.view);this.viewName=this.viewsName[n],this.pipeline={}}return _createClass(s,[{key:"mountGroup",value:function(e,t){return new t(e,e.getAttribute("protype-group"),this.viewName)}},{key:"onPipelineChange",value:function(e){}},{key:"willDisappear",value:function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0]}},{key:"willShow",value:function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0]}}]),s}()}}]),_createClass(e,[{key:"mount",value:function(){for(var e=[].concat(Array.prototype.slice.call(arguments)),t=0;t<e.length;t++)this.views.push(e[t][1]),this.viewsName.push(e[t][0]);for(var i=0;i<e.length;i++)this.controllers.push(new e[i][2](this.views[i],this.viewsName,this.views))}},{key:"performTransition",value:function(e,t){var i=Object.assign({animation:"none",duration:"1s",Group:!1},t),n=this.currentView,s=this.viewsName.indexOf(n),r=this.views[s],o=this.controllers[s],a=this.viewsName.indexOf(e),l=this.views[a].cloneNode(!0);this.views[a].parentNode.replaceChild(l,this.views[a]),this.views[a]=l;var u=this.views[a],h=this.controllers[a];if(h.view=u,h.views=this.views,this.currentView=e,u.setAttribute("style",""),u.style["z-index"]="-10",h.willShow(),!1!==i.Group){var c=function(){u.style.display="block",u.style["z-index"]="0",r.style.display="none",o.willDisappear()};"none"!==i.animation?(i.Group.group.style.animation=i.animation+" "+i.duration+" forwards",i.Group.addEventListener("animationend",function(e){return c()})):c()}else{u.style.display="block";var p=function(){u.style["z-index"]="0",r.style.display="none",o.willDisappear(),u.style.display="block"};"none"!==i.animation?(r.style.animation=i.animation+" "+i.duration+" forwards",r.addEventListener("animationend",function(e){return p()})):p()}}},{key:"setPipeline",value:function(e){var t=this.currentView,i=this.viewsName.indexOf(t),n=this.views[i].pipeline;JSON.stringify(n)!=JSON.stringify(e)&&(this.views[i].pipeline=e,this.views[i].onPipelineChange(e))}},{key:"set",value:function(i){var n=this;this.currentView=i,document.addEventListener("DOMContentLoaded",function(e){for(var t=0;t<n.views.length;t++)n.viewsName[t]==i?(n.views[t].style.display="block",n.controllers[t].willShow()):n.views[t].style.display="none"})}},{key:"pipeline",get:function(){var e=this.currentView,t=this.viewsName.indexOf(e);return this.views[t].pipeline}}]),e}();"function"==typeof define&&define.amd?define(function(){return new ProType}):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=new ProType),exports.ProType=new ProType):"undefined"!=typeof global&&(global.ProType=new ProType);