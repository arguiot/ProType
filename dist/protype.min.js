"use strict";var _createClass=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var ProType=function(){function e(){_classCallCheck(this,e),this.version="v1.1.0",this.views=[],this.viewsName=[],this.controllers=[],this.currentView="",this.last="",this.root="",this.workspace={}}return _createClass(e,[{key:"mountExternalGroup",value:function(e,t){return new t(e,null)}},{key:"Router",value:function(h){document.addEventListener("DOMContentLoaded",function(e){var t={},n=window.location.href;t.url=n;var i=window.location.origin;t.origin=i;var s=window.location.pathname;t.path=s;var o=window.location.hash;t.hash=o;for(var r=window.location.search.substring(1).split("&"),a={},l=0;l<r.length;l++){var u=r[l].split("=");a[decodeURIComponent(u[0])]=decodeURIComponent(u[1])}t.search=a,t.pathValue=s.split("/"),h(t)})}},{key:"autoMount",value:function(){var e,t=[].concat(Array.prototype.slice.call(arguments)),n=document.querySelectorAll("[protype]");if((e=this.views).push.apply(e,_toConsumableArray(n)),n.length!=t.length)throw"Controllers and Elements don't match";for(var i=0;i<n.length;i++)this.viewsName.push(n[i].getAttribute("protype"));for(var s=0;s<t.length;s++)this.controllers.push(new t[s](n[s],this.viewsName,this.views))}},{key:"Component",get:function(){return function(){function t(e){_classCallCheck(this,t),this.component=e,this.state={},this.render()}return _createClass(t,[{key:"render",value:function(){this.component.innerHTML=""}}]),t}()}},{key:"Group",get:function(){return function(){function n(e,t){_classCallCheck(this,n),this.group=e,this.viewName=t,this.state={},this.init()}return _createClass(n,[{key:"changeHandler",value:function(e){}}]),_createClass(n,[{key:"init",value:function(){}},{key:"mountComponent",value:function(e,t){return new t(e)}},{key:"setState",value:function(e){JSON.stringify(e)!=JSON.stringify(this.state)&&(this.state=e,this.changeHandler(this.state))}}]),n}()}},{key:"ViewController",get:function(){return function(){function s(e,t,n){_classCallCheck(this,s),this.view=e,this.views=n,this.viewsName=t;var i=this.views.indexOf(this.view);this.viewName=this.viewsName[i],this.pipeline={},this.preload()}return _createClass(s,[{key:"mountGroup",value:function(e,t){return new t(e,this.viewName)}},{key:"mountGroups",value:function(e,t){for(var n=[],i=0;i<e.length;i++)n.push(new t(e[i],this.viewName));return n}},{key:"onPipelineChange",value:function(e){}},{key:"preload",value:function(){}},{key:"prepareForSegue",value:function(e){}},{key:"willDisappear",value:function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0]}},{key:"willShow",value:function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0]}}]),s}()}}]),_createClass(e,[{key:"mount",value:function(){for(var e=[].concat(Array.prototype.slice.call(arguments)),t=0;t<e.length;t++)this.views.push(e[t][1]),this.viewsName.push(e[t][0]);for(var n=0;n<e.length;n++)this.controllers.push(new e[n][2](this.views[n],this.viewsName,this.views))}},{key:"performTransition",value:function(e,t){if(e!=this.currentView){var n=Object.assign({animation:"none",duration:"1s",Group:!1},t),i=this.currentView,s=this.viewsName.indexOf(i),o=this.views[s],r=this.controllers[s],a=this.viewsName.indexOf(e),l=this.views[a].cloneNode(!0);this.views[a].parentNode.replaceChild(l,this.views[a]),this.views[a]=l;var u=this.views[a],h=this.controllers[a];if(h.view=u,h.views=this.views,this.last=this.currentView,this.currentView=e,u.setAttribute("style",""),u.style["z-index"]="-10",r.prepareForSegue(h),h.willShow(i),!1!==n.Group){var c=function(){u.style.display="block",u.style["z-index"]="0",o.style.display="none",r.willDisappear(i)};"none"!==n.animation?(n.Group.style.animation=n.animation+" "+n.duration+" forwards",n.Group.addEventListener("animationend",function(e){return c()})):c()}else{u.style.display="block";var p=function(){u.style["z-index"]="0",o.style.display="none",r.willDisappear(i),u.style.display="block"};"none"!==n.animation?(o.style.animation=n.animation+" "+n.duration+" forwards",o.addEventListener("animationend",function(e){return p()})):p()}}}},{key:"setPipeline",value:function(e){var t=this.currentView,n=this.viewsName.indexOf(t),i=this.views[n].pipeline;JSON.stringify(i)!=JSON.stringify(e)&&(this.views[n].pipeline=e,this.views[n].onPipelineChange(e))}},{key:"pop",value:function(){this.performTransition(this.last)}},{key:"popToRoot",value:function(){this.performTransition(this.root)}},{key:"set",value:function(n){var i=this;this.root=n,this.currentView=n,document.addEventListener("DOMContentLoaded",function(e){for(var t=0;t<i.views.length;t++)i.viewsName[t]==n?(i.views[t].style.display="block",i.controllers[t].willShow()):i.views[t].style.display="none"})}},{key:"pipeline",get:function(){var e=this.currentView,t=this.viewsName.indexOf(e);return this.views[t].pipeline}}]),e}();"function"==typeof define&&define.amd?define(function(){return new ProType}):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=new ProType),exports.ProType=new ProType):"undefined"!=typeof global&&(global.ProType=new ProType);